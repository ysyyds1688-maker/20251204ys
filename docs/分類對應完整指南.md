# 分類對應完整指南

## 📋 概述

本指南包含分類對應關係說明、更新記錄、測試方法和問題排查，是管理 Google Sheet 分頁與論壇分類對應的完整參考。

---

## 🎯 分類對應表（核心）

### 最終對應關係

| Google Sheet 分頁 | Category 值（必須精確） | 論壇分類 ID | 論壇分類名稱 | 測試 URL |
|------------------|---------------------|------------|------------|---------|
| **娛樂城評價類** | `娛樂城評價` | 2 | 娛樂城評價 | `/forum/c/2` |
| **優惠活動類** | `優惠情報` | 4 | 優惠情報 | `/forum/c/4` |
| **真人百家樂類** | `遊戲攻略` | 3 | 遊戲攻略 | `/forum/c/3` |
| **體育與電子類** | `遊戲攻略` | 3 | 遊戲攻略 | `/forum/c/3` |
| **綜合討論類** | `綜合討論` | 1 | 綜合討論 | `/forum/c/1` |

### ⚠️ 重要變更記錄

**體育與電子類** 現在也對應到「遊戲攻略」分類：
- 真人百家樂類 → Category: `遊戲攻略` → 顯示在 `/forum/c/3`
- 體育與電子類 → Category: `遊戲攻略` → 顯示在 `/forum/c/3`

**兩個分頁的文章都會顯示在同一個「遊戲攻略」論壇分類中。**

---

## 🆕 綜合討論分類設定

### 方案：新增 Google Sheet 分頁（推薦）

1. **分頁名稱**：`綜合討論類`
2. **Category 值**：`綜合討論`
3. **對應論壇**：ID: 1，名稱：綜合討論
4. **測試 URL**：`/forum/c/1`

### 設定步驟

1. 在 Google Sheet 中新增分頁「綜合討論類」
2. 設定欄位結構（與其他分頁相同）：
   ```
   Keyword | GEO | Category | Content | title | Excerpt | Status | Date
   ```
3. 在 `ArticleService.ts` 中新增 CSV URL：
   ```typescript
   // 分頁 5：綜合討論類
   'https://docs.google.com/spreadsheets/d/1eMQUXRcn9-wELa8cLoK6kXrdnEnkZoMyMzAtCH1Bmes/export?format=csv&gid=新的GID',
   ```

---

## ✅ 測試步驟

### 步驟 1：檢查 Google Sheet 中的文章

對每個分頁，檢查：

1. **打開 Google Sheet**
   - Sheet ID: `1eMQUXRcn9-wELa8cLoK6kXrdnEnkZoMyMzAtCH1Bmes`

2. **檢查每個分頁的 Status=done 文章**：
   - 娛樂城評價類：確認 Category 欄位 = `娛樂城評價`
   - 優惠活動類：確認 Category 欄位 = `優惠情報`
   - 真人百家樂類：確認 Category 欄位 = `遊戲攻略`
   - 體育與電子類：確認 Category 欄位 = `遊戲攻略`
   - 綜合討論類：確認 Category 欄位 = `綜合討論`

3. **記錄問題**：
   - 如果 Category 欄位不正確，需要修正
   - 如果 Status 不是 `done`，文章不會顯示

### 步驟 2：前端測試

#### 測試 1：娛樂城評價（ID: 2）
1. 訪問：`https://你的網址/forum/c/2`
2. 檢查：
   - ✅ 頁面標題顯示「娛樂城評價」
   - ✅ 文章列表中有來自「娛樂城評價類」分頁的文章

#### 測試 2：優惠情報（ID: 4）
1. 訪問：`https://你的網址/forum/c/4`
2. 檢查：
   - ✅ 頁面標題顯示「優惠情報」
   - ✅ 文章列表中有來自「優惠活動類」分頁的文章

#### 測試 3：遊戲攻略（ID: 3）
1. 訪問：`https://你的網址/forum/c/3`
2. 檢查：
   - ✅ 頁面標題顯示「遊戲攻略」
   - ✅ 文章列表中有來自「真人百家樂類」和「體育與電子類」分頁的文章

#### 測試 4：綜合討論（ID: 1）
1. 訪問：`https://你的網址/forum/c/1`
2. 檢查：
   - ✅ 頁面標題顯示「綜合討論」
   - ✅ 文章列表中有來自「綜合討論類」分頁的文章

### 步驟 3：檢查主控台（開發者工具）

1. 打開瀏覽器開發者工具（F12）
2. 切換到「Console」標籤
3. 檢查是否有錯誤訊息
4. 查看日誌：
   - `Total articles from all sheets: X`（應該顯示總文章數）
   - `Filtered articles from [URL]: X`（每個分頁的文章數）

---

## 🔧 問題排查

### 問題 1：文章沒有出現在對應分類

**可能原因**：
1. Category 欄位不正確
2. Status 不是 `done`
3. 前端快取問題

**解決方案**：
1. 檢查 Google Sheet 中的 Category 欄位是否完全匹配
2. 確認 Status 欄位 = `done`
3. 硬刷新瀏覽器（Cmd+Shift+R 或 Ctrl+Shift+R）
4. 檢查前端代碼中的分類映射（`ForumCategoryPage.tsx`）

### 問題 2：文章出現在錯誤的分類

**可能原因**：
- Category 欄位寫入錯誤

**解決方案**：
1. 檢查 n8n 工作流中的 Code 節點
2. 確認 Category 設定邏輯正確
3. 修正 Google Sheet 中的 Category 欄位

### 問題 3：所有分類都顯示相同文章

**可能原因**：
- 前端篩選邏輯有問題

**解決方案**：
1. 檢查 `ForumCategoryPage.tsx` 中的篩選邏輯
2. 確認 `categoryNameMap` 對應關係正確

---

## 🎯 修正 Category 欄位的方法

### 方法 1：手動修正 Google Sheet

1. 打開 Google Sheet
2. 找到 Category 欄位不正確的行
3. 手動修改為正確值：
   - `娛樂城評價`
   - `優惠情報`
   - `遊戲攻略`
   - `綜合討論`

### 方法 2：使用 n8n 批量修正

1. 建立新的 n8n 工作流
2. 讀取所有 Status=done 的文章
3. 使用 Code 節點修正 Category：
   ```javascript
   const categoryMap = {
     '娛樂城評價類': '娛樂城評價',
     '優惠活動類': '優惠情報',
     '真人百家樂類': '遊戲攻略',
     '體育與電子類': '遊戲攻略',
     '綜合討論類': '綜合討論'
   };
   
   return {
     json: {
       ...$input.item.json,
       Category: categoryMap[sheetName] || $input.item.json.Category
     }
   };
   ```
4. 更新 Google Sheet

---

## 📊 測試檢查清單

### Google Sheet 檢查

- [ ] 娛樂城評價類：至少 1 篇文章，Status=done，Category=`娛樂城評價`
- [ ] 優惠活動類：至少 1 篇文章，Status=done，Category=`優惠情報`
- [ ] 真人百家樂類：至少 1 篇文章，Status=done，Category=`遊戲攻略`
- [ ] 體育與電子類：至少 1 篇文章，Status=done，Category=`遊戲攻略`
- [ ] 綜合討論類：至少 1 篇文章，Status=done，Category=`綜合討論`

### 前端測試

- [ ] `/forum/c/2` 顯示「娛樂城評價」分類的文章
- [ ] `/forum/c/4` 顯示「優惠情報」分類的文章
- [ ] `/forum/c/3` 顯示「遊戲攻略」分類的文章
- [ ] `/forum/c/1` 顯示「綜合討論」分類的文章
- [ ] 所有文章詳情頁正常顯示

### 主控台檢查

- [ ] 沒有 JavaScript 錯誤
- [ ] 文章載入日誌正常
- [ ] 沒有 404 或網路錯誤

---

## 🔧 n8n 工作流中的分類映射

### 自動發文工作流

在 Code 節點中使用：

```javascript
const categoryMap = {
  '927317477': '娛樂城評價',  // 娛樂城評價類
  '677810879': '優惠情報',    // 優惠活動類
  '80898864': '遊戲攻略',     // 真人百家樂類
  '1456663743': '遊戲攻略',   // 體育與電子類
  '新GID': '綜合討論'         // 綜合討論類
};
```

### AI 生成關鍵字工作流

```javascript
const categories = [
  {
    name: '娛樂城評價',
    sheetGid: '927317477',
    category: '娛樂城評價'
  },
  {
    name: '優惠情報',
    sheetGid: '677810879',
    category: '優惠情報'
  },
  {
    name: '遊戲攻略',
    sheetGid: '80898864',
    category: '遊戲攻略'
  },
  {
    name: '遊戲攻略',  // 體育與電子類也對應遊戲攻略
    sheetGid: '1456663743',
    category: '遊戲攻略'
  },
  {
    name: '綜合討論',
    sheetGid: '新GID',
    category: '綜合討論'
  }
];
```

---

## 📝 關鍵字建議（綜合討論）

### 產業新聞類
- YS娛樂城產業新聞
- YS娛樂城法規變更
- YS娛樂城市場趨勢

### 玩家心得類
- YS娛樂城玩家心得
- YS娛樂城玩家分享
- YS娛樂城經驗談

### 新手教學類
- YS娛樂城新手教學
- YS娛樂城入門指南
- YS娛樂城常見問題

### 綜合討論類
- YS娛樂城討論區
- YS娛樂城論壇
- YS娛樂城熱門話題

---

## 🔗 相關文件

- `n8n_自動發文完整指南.md` - 自動發文工作流
- `n8n_關鍵字管理完整指南.md` - 關鍵字管理工作流
- `圖片管理完整指南.md` - 圖片管理說明

